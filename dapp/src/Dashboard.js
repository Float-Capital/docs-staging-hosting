// Generated by ReScript, PLEASE EDIT WITH CARE

import * as Curry from "bs-platform/lib/es6/curry.js";
import * as React from "react";
import * as Ethers from "./ethereum/Ethers.js";
import * as Queries from "./libraries/Queries.js";
import * as Belt_Array from "bs-platform/lib/es6/belt_Array.js";
import * as DaiBalance from "./components/ExampleViewFunctions/DaiBalance.js";
import * as Router from "next/router";
import * as AccessControl from "./components/AccessControl.js";
import FromUnixTime from "date-fns/fromUnixTime";
import FormatDistanceToNow from "date-fns/formatDistanceToNow";

function Dashboard(Props) {
  var router = Router.useRouter();
  var match = Curry.app(Queries.LatestSystemState.use, [
        undefined,
        undefined,
        undefined,
        undefined,
        undefined,
        undefined,
        undefined,
        undefined,
        undefined,
        undefined,
        undefined,
        undefined,
        undefined,
        undefined
      ]);
  var match$1 = match.data;
  var tmp;
  if (match.loading) {
    tmp = "Loading...";
  } else if (match.error !== undefined) {
    tmp = "Error loading data";
  } else if (match$1 !== undefined) {
    var match$2 = match$1.systemStates;
    if (match$2.length !== 1) {
      tmp = "Query returned wrong number of results";
    } else {
      var match$3 = match$2[0];
      var timeSinceUpdate = FormatDistanceToNow(FromUnixTime(match$3.timestamp.toNumber()));
      tmp = React.createElement(React.Fragment, undefined, React.createElement("a", {
                href: "https://goerli.etherscan.io/tx/" + match$3.txHash
              }, "Latest update happened " + timeSinceUpdate + " ago. (view on block-explorer) by " + match$3.setBy), React.createElement("p", undefined, "SyntheticPrice " + Ethers.Utils.formatEther(match$3.syntheticPrice) + "$"), React.createElement("p", undefined, "Long Token Price " + Ethers.Utils.formatEther(match$3.longTokenPrice) + "$"), React.createElement("p", undefined, "Short Token Price " + Ethers.Utils.formatEther(match$3.shortTokenPrice) + "$"), React.createElement("p", undefined, "Total locked long " + Ethers.Utils.formatEther(match$3.totalLockedLong) + "$"), React.createElement("p", undefined, "Total Locked Short " + Ethers.Utils.formatEther(match$3.totalLockedShort) + "$"), React.createElement("p", undefined, "Total Locked " + Ethers.Utils.formatEther(match$3.totalValueLocked) + "$"), React.createElement("p", undefined, "TODO:"), React.createElement("p", undefined, "show the ratio of long to short in the same chart"), React.createElement("p", undefined, "show historic returns of long asset (history APY)"), React.createElement("p", undefined, "show current APY on opposing side (probably short)"));
    }
  } else {
    tmp = "You might think this is impossible, but depending on the situation it might not be!";
  }
  var match$4 = Curry.app(Queries.MarketDetails.use, [
        undefined,
        undefined,
        undefined,
        undefined,
        undefined,
        undefined,
        undefined,
        undefined,
        undefined,
        undefined,
        undefined,
        undefined,
        undefined,
        undefined
      ]);
  var match$5 = match$4.data;
  return React.createElement(AccessControl.make, {
              children: null,
              alternateComponent: React.createElement("h1", {
                    onClick: (function (param) {
                        router.push("/login?nextPath=/dashboard");
                        
                      })
                  }, "Login to view your dashboard")
            }, React.createElement("h1", undefined, "Dashboard"), React.createElement(DaiBalance.make, {}), tmp, match$4.loading ? "Loading..." : (
                match$4.error !== undefined ? "Error loading data" : (
                    match$5 !== undefined ? React.createElement(React.Fragment, undefined, React.createElement("h1", undefined, "Markets"), Belt_Array.map(match$5.syntheticMarkets, (function (param) {
                                  return React.createElement("div", {
                                              key: param.symbol
                                            }, param.name);
                                }))) : "You might think this is impossible, but depending on the situation it might not be!"
                  )
              ));
}

var make = Dashboard;

var $$default = Dashboard;

export {
  make ,
  $$default ,
  $$default as default,
  
}
/* react Not a pure module */
