// Generated by ReScript, PLEASE EDIT WITH CARE
'use strict';

var Js_dict = require("rescript/lib/js/js_dict.js");
var Queries = require("../Queries.bs.js");
var Belt_Array = require("rescript/lib/js/belt_Array.js");
var Belt_Option = require("rescript/lib/js/belt_Option.js");

var allStateChangesRaw = Queries.getAllStateChanges(undefined);

var filePreRamble = "type address = string\n\ntype unclassifiedEvent = {\n  name: string,\n  data: Js.Dict.t<string>,\n}";

var typesString = {
  contents: ""
};

var variantTypeString = {
  contents: "type stateChanges =\n  | Unclassified(unclassifiedEvent)"
};

var lowercaseFirstLetter = ((word) => word.charAt(0).toLowerCase() + word.slice(1));

function paramTypeToRescriptType(paramType) {
  switch (paramType) {
    case "address" :
        return "address";
    case "string" :
        return "string";
    case "uint256" :
    case "uint32" :
        return "BN.t";
    default:
      console.log("Please handle all types - " + paramType + " isn't handled by this script.");
      return "unkownType";
  }
}

allStateChangesRaw.then(function (allStateChanges) {
      var uniqueStateChangeTypes = {};
      Belt_Array.forEach(allStateChanges, (function (param) {
              return Belt_Array.forEach(param.txEventParamList, (function (param) {
                            var eventName = param.eventName;
                            var eventGenerated = Belt_Option.isNone(Js_dict.get(uniqueStateChangeTypes, eventName));
                            if (!eventGenerated) {
                              return ;
                            }
                            uniqueStateChangeTypes[eventName] = "set";
                            var recordFields = Belt_Array.reduce(param.params, "", (function (acc, param) {
                                    return acc + ("\n  " + param.paramName + ": " + paramTypeToRescriptType(param.paramType) + ",");
                                  }));
                            var eventDataTypeName = lowercaseFirstLetter(eventName) + "Data";
                            typesString.contents = typesString.contents + ("\ntype " + eventDataTypeName + " = {" + recordFields + "\n}");
                            variantTypeString.contents = variantTypeString.contents + ("\n  | " + eventName + "(" + eventDataTypeName + ")");
                            
                          }));
            }));
      console.log(filePreRamble + "\n" + typesString.contents + "\n\n" + variantTypeString.contents);
      
    });

exports.allStateChangesRaw = allStateChangesRaw;
exports.filePreRamble = filePreRamble;
exports.typesString = typesString;
exports.variantTypeString = variantTypeString;
exports.lowercaseFirstLetter = lowercaseFirstLetter;
exports.paramTypeToRescriptType = paramTypeToRescriptType;
/* allStateChangesRaw Not a pure module */
